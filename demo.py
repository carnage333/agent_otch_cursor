#!/usr/bin/env python3
"""
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è AI-–∞–≥–µ–Ω—Ç–∞ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ –ø–æ —Ä–µ–∫–ª–∞–º–Ω—ã–º –∫–∞–º–ø–∞–Ω–∏—è–º
"""

import sys
import time
from ai_agent import MarketingAnalyticsAgent
from rag_system import RAGSystem

def print_header(title: str):
    """–ö—Ä–∞—Å–∏–≤—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫"""
    print("\n" + "="*60)
    print(f"üéØ {title}")
    print("="*60)

def print_section(title: str):
    """–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü–∏–∏"""
    print(f"\nüìã {title}")
    print("-" * 40)

def demo_agent_capabilities():
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –∞–≥–µ–Ω—Ç–∞"""
    
    print_header("AI-–∞–≥–µ–Ω—Ç –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ | –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π")
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞
    print("ü§ñ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è AI-–∞–≥–µ–Ω—Ç–∞...")
    agent = MarketingAnalyticsAgent()
    print("‚úÖ –ê–≥–µ–Ω—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    
    # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è RAG —Å–∏—Å—Ç–µ–º—ã
    print_section("RAG —Å–∏—Å—Ç–µ–º–∞ - –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –∑–Ω–∞–Ω–∏—è")
    rag = RAGSystem()
    
    test_queries = [
        "–ß—Ç–æ —Ç–∞–∫–æ–µ CTR?",
        "–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ø–Ω–¥–µ–∫—Å.–î–∏—Ä–µ–∫—Ç?",
        "–ß—Ç–æ —Ç–∞–∫–æ–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±—é–¥–∂–µ—Ç–∞?"
    ]
    
    for query in test_queries:
        print(f"\nüîç –ü–æ–∏—Å–∫ –∑–Ω–∞–Ω–∏–π –¥–ª—è: '{query}'")
        items = rag.search_knowledge(query)
        if items:
            for item in items:
                print(f"  üìö {item.term}: {item.definition}")
        else:
            print("  ‚ùå –ó–Ω–∞–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
    
    # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö
    print_section("–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤")
    
    demo_questions = [
        "–ü–æ–∫–∞–∂–∏ –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Ä–µ–∫–ª–∞–º–Ω—ã–º –∫–∞–º–ø–∞–Ω–∏—è–º",
        "–ö–∞–∫–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏ —Å–∞–º—ã–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ?",
        "–ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —Ä–∞–∑–Ω—ã–µ –ø–ª–æ—â–∞–¥–∫–∏?",
        "–ü–æ–∫–∞–∂–∏ —Ç—Ä–µ–Ω–¥—ã –ø–æ –¥–Ω—è–º"
    ]
    
    for i, question in enumerate(demo_questions, 1):
        print(f"\n{i}. –í–æ–ø—Ä–æ—Å: {question}")
        print("ü§ñ –ê–≥–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ...")
        
        start_time = time.time()
        report = agent.process_question(question)
        end_time = time.time()
        
        print(f"‚è±Ô∏è –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏: {end_time - start_time:.2f} —Å–µ–∫")
        print("üìä –û—Ç—á–µ—Ç:")
        print(report[:500] + "..." if len(report) > 500 else report)
    
    # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–Ω–æ—Å—Ç–∏
    print_section("–£—Ä–æ–≤–Ω–∏ –∞–≥–µ–Ω—Ç–Ω–æ—Å—Ç–∏")
    
    agent_capabilities = [
        "‚úÖ –ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–æ–ª–∏ - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –∞–Ω–∞–ª–∏—Ç–∏–∫ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞",
        "‚úÖ –ü–æ–Ω–∏–º–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ - –∞–Ω–∞–ª–∏–∑ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞",
        "‚úÖ –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è SQL –∑–∞–ø—Ä–æ—Å–æ–≤",
        "‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –∑–Ω–∞–Ω–∏—è - –ø—Ä–µ–¥–º–µ—Ç–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞",
        "‚úÖ –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è - –∞–Ω–∞–ª–∏–∑ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤"
    ]
    
    for capability in agent_capabilities:
        print(f"  {capability}")
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    print_section("–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è")
    
    history = agent.get_conversation_history()
    print(f"üìà –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤: {len(history) // 2}")
    print(f"üí¨ –û–±—â–∞—è –¥–ª–∏–Ω–∞ –¥–∏–∞–ª–æ–≥–∞: {len(history)} —Å–æ–æ–±—â–µ–Ω–∏–π")
    
    # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∫–æ–º–∏—Å—Å–∏–∏
    print_section("–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∑–∞—â–∏—Ç—ã –ø–µ—Ä–µ–¥ –∫–æ–º–∏—Å—Å–∏–µ–π")
    
    recommendations = [
        "üéØ –ü–æ–¥—á–µ—Ä–∫–Ω—É—Ç—å –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –∞–≥–µ–Ω—Ç–Ω–æ—Å—Ç–∏ - —Å–∏—Å—Ç–µ–º–∞ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ",
        "üìä –ü–æ–∫–∞–∑–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –∞–Ω–∞–ª–∏–∑–∞ - –∏–Ω—Å–∞–π—Ç—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏",
        "üí¨ –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å - –¥–∏–∞–ª–æ–≥ –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ",
        "üîß –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é - SQL –≥–µ–Ω–µ—Ä–∞—Ü–∏—è, RAG —Å–∏—Å—Ç–µ–º–∞",
        "üìà –ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –±–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä—É—Ç–∏–Ω–Ω—ã—Ö –∑–∞–¥–∞—á"
    ]
    
    for rec in recommendations:
        print(f"  {rec}")

def demo_web_interface():
    """–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞"""
    print_section("–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å")
    
    print("üåê –î–ª—è –∑–∞–ø—É—Å–∫–∞ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:")
    print("   streamlit run app.py")
    print("\nüì± –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É:")
    print("   http://localhost:8501")
    
    print("\nüé® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:")
    web_features = [
        "üí¨ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –¥–∏–∞–ª–æ–≥ —Å –∞–≥–µ–Ω—Ç–æ–º",
        "üìà –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç—á–µ—Ç—ã –ø–æ –∫–Ω–æ–ø–∫–∞–º",
        "üìä –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è",
        "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π"
    ]
    
    for feature in web_features:
        print(f"  {feature}")

def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏"""
    
    if len(sys.argv) > 1 and sys.argv[1] == "--web":
        demo_web_interface()
    else:
        demo_agent_capabilities()
    
    print_header("–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞")
    print("üéâ AI-–∞–≥–µ–Ω—Ç –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!")
    print("\nüìû –î–ª—è –∑–∞–ø—É—Å–∫–∞ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞: python demo.py --web")

if __name__ == "__main__":
    main() 