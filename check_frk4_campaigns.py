import sqlite3
import pandas as pd

def check_frk4_campaigns():
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–º–ø–∞–Ω–∏–π –§–†–ö4 –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö"""
    conn = sqlite3.connect('marketing_analytics.db')
    
    print("üîç –ü–æ–∏—Å–∫ –∫–∞–º–ø–∞–Ω–∏–π –§–†–ö4 –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö")
    print("=" * 50)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –∫–∞–º–ø–∞–Ω–∏–∏ —Å –§–†–ö4
    query = """
    SELECT DISTINCT "–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏" 
    FROM campaign_metrics 
    WHERE UPPER("–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏") LIKE '%–§–†–ö4%'
       OR UPPER("–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏") LIKE '%–§–†–ö 4%'
       OR UPPER("–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏") LIKE '%–§–†–ö-4%'
    ORDER BY "–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏"
    """
    
    df = pd.read_sql_query(query, conn)
    print(f"–ù–∞–π–¥–µ–Ω–æ –∫–∞–º–ø–∞–Ω–∏–π —Å –§–†–ö4: {len(df)}")
    
    if len(df) > 0:
        print("\n–°–ø–∏—Å–æ–∫ –∫–∞–º–ø–∞–Ω–∏–π –§–†–ö4:")
        for idx, row in df.iterrows():
            print(f"  {idx+1}. {row['–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏']}")
    else:
        print("\n‚ùå –ö–∞–º–ø–∞–Ω–∏–∏ –§–†–ö4 –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –∫–∞–º–ø–∞–Ω–∏–∏ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
        print("\n–ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –∫–∞–º–ø–∞–Ω–∏–∏ –≤ –±–∞–∑–µ:")
        all_campaigns = pd.read_sql_query("SELECT DISTINCT \"–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏\" FROM campaign_metrics ORDER BY \"–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏\"", conn)
        print(f"–í—Å–µ–≥–æ –∫–∞–º–ø–∞–Ω–∏–π –≤ –±–∞–∑–µ: {len(all_campaigns)}")
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 20 –∫–∞–º–ø–∞–Ω–∏–π
        print("\n–ü–µ—Ä–≤—ã–µ 20 –∫–∞–º–ø–∞–Ω–∏–π:")
        for idx, row in all_campaigns.head(20).iterrows():
            print(f"  {idx+1}. {row['–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏']}")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–∞–º–ø–∞–Ω–∏–∏
    print("\n" + "=" * 50)
    print("–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–º–ø–∞–Ω–∏–∏ '–§–†–ö4 –ë–∏–∑–Ω–µ—Å-–§–µ—Å—Ç, –∞–ø—Ä–µ–ª—å':")
    
    test_query = """
    SELECT "–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏", "–ü–ª–æ—â–∞–¥–∫–∞", "–ü–æ–∫–∞–∑—ã", "–ö–ª–∏–∫–∏", "–†–∞—Å—Ö–æ–¥ –¥–æ –ù–î–°"
    FROM campaign_metrics 
    WHERE "–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏" = '–§–†–ö4 –ë–∏–∑–Ω–µ—Å-–§–µ—Å—Ç, –∞–ø—Ä–µ–ª—å'
    LIMIT 5
    """
    
    test_df = pd.read_sql_query(test_query, conn)
    print(f"–ó–∞–ø–∏—Å–µ–π –¥–ª—è '–§–†–ö4 –ë–∏–∑–Ω–µ—Å-–§–µ—Å—Ç, –∞–ø—Ä–µ–ª—å': {len(test_df)}")
    
    if len(test_df) > 0:
        print("\n–î–∞–Ω–Ω—ã–µ:")
        print(test_df)
    else:
        print("‚ùå –î–∞–Ω–Ω—ã–µ –¥–ª—è '–§–†–ö4 –ë–∏–∑–Ω–µ—Å-–§–µ—Å—Ç, –∞–ø—Ä–µ–ª—å' –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
    
    conn.close()

if __name__ == "__main__":
    check_frk4_campaigns() 